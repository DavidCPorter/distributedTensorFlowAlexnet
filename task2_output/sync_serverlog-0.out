Extracting MNIST_data/train-images-idx3-ubyte.gz
WARNING:tensorflow:From lr_sync.py:52: read_data_sets (from tensorflow.contrib.learn.python.learn.datasets.mnist) is deprecated and will be removed in a future version.
Instructions for updating:
Please use alternatives such as official/mnist/dataset.py from tensorflow/models.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py:260: maybe_download (from tensorflow.contrib.learn.python.learn.datasets.base) is deprecated and will be removed in a future version.
Instructions for updating:
Please write your own downloading logic.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py:262: extract_images (from tensorflow.contrib.learn.python.learn.datasets.mnist) is deprecated and will be removed in a future version.
Instructions for updating:
Please use tf.data to implement this functionality.
Extracting MNIST_data/train-labels-idx1-ubyte.gz
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py:267: extract_labels (from tensorflow.contrib.learn.python.learn.datasets.mnist) is deprecated and will be removed in a future version.
Instructions for updating:
Please use tf.data to implement this functionality.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py:110: dense_to_one_hot (from tensorflow.contrib.learn.python.learn.datasets.mnist) is deprecated and will be removed in a future version.
Instructions for updating:
Please use tf.one_hot on tensors.
Extracting MNIST_data/t10k-images-idx3-ubyte.gz
Extracting MNIST_data/t10k-labels-idx1-ubyte.gz
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py:290: DataSet.__init__ (from tensorflow.contrib.learn.python.learn.datasets.mnist) is deprecated and will be removed in a future version.
Instructions for updating:
Please use alternatives such as official/mnist/dataset.py from tensorflow/models.
2019-04-23 15:46:43.701082: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-04-23 15:46:43.710409: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2394320000 Hz
2019-04-23 15:46:43.712761: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2f44060 executing computations on platform Host. Devices:
2019-04-23 15:46:43.712791: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-04-23 15:46:43.714773: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job ps -> {0 -> 10.10.1.1:3333}
2019-04-23 15:46:43.714788: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2222, 1 -> 10.10.1.2:2222}
2019-04-23 15:46:43.717615: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:391] Started server with target: grpc://localhost:2222
featureCount->  784 classCount->  10
trainSize->  55000
train images: (55000, 784)
train labels: (55000, 10)
 test images: (10000, 784)
 test labels: (10000, 10)
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From lr_sync.py:119: SyncReplicasOptimizer.__init__ (from tensorflow.python.training.sync_replicas_optimizer) is deprecated and will be removed in a future version.
Instructions for updating:
The `SyncReplicaOptimizer` class is deprecated. For synchrononous training, please use [Distribution Strategies](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/distribute).
INFO:tensorflow:SyncReplicasV2: replicas_to_aggregate=2; total_num_replicas=2
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/ops/data_flow_ops.py:1294: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/sync_replicas_optimizer.py:352: QueueRunner.__init__ (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from /tmp/train_log/model.ckpt-16
2019-04-23 15:46:43.951386: I tensorflow/core/distributed_runtime/master_session.cc:1192] Start master session b0cdc1a05b1175ea with config: 
WARNING:tensorflow:From /users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1070: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 16 into /tmp/train_log/model.ckpt.
INFO:tensorflow:global_step/sec: 150.518
INFO:tensorflow:global_step/sec: 235.422
INFO:tensorflow:global_step/sec: 280.579
INFO:tensorflow:global_step/sec: 281.634
INFO:tensorflow:global_step/sec: 281.963
INFO:tensorflow:global_step/sec: 280.779
INFO:tensorflow:global_step/sec: 279.623
INFO:tensorflow:global_step/sec: 275.548
Worker 0,  Epoch: 1 Cost: 1.1302
gs-> 1078
INFO:tensorflow:global_step/sec: 282.852
INFO:tensorflow:global_step/sec: 281.103
INFO:tensorflow:global_step/sec: 283.158
INFO:tensorflow:global_step/sec: 278.278
INFO:tensorflow:global_step/sec: 279.91
INFO:tensorflow:global_step/sec: 280.196
INFO:tensorflow:global_step/sec: 281.872
INFO:tensorflow:global_step/sec: 281.933
INFO:tensorflow:global_step/sec: 280.578
INFO:tensorflow:global_step/sec: 281.137
Worker 0,  Epoch: 2 Cost: 0.6353
gs-> 2078
INFO:tensorflow:global_step/sec: 283.157
INFO:tensorflow:global_step/sec: 281.67
INFO:tensorflow:global_step/sec: 280.554
INFO:tensorflow:global_step/sec: 282.531
INFO:tensorflow:global_step/sec: 275.907
INFO:tensorflow:global_step/sec: 282.557
INFO:tensorflow:global_step/sec: 280.214
INFO:tensorflow:global_step/sec: 284.297
INFO:tensorflow:global_step/sec: 274.831
INFO:tensorflow:global_step/sec: 272.662
Worker 0,  Epoch: 3 Cost: 0.4367
gs-> 3078
INFO:tensorflow:global_step/sec: 274.616
INFO:tensorflow:global_step/sec: 274.474
INFO:tensorflow:global_step/sec: 271.491
INFO:tensorflow:global_step/sec: 274.044
INFO:tensorflow:global_step/sec: 274.905
INFO:tensorflow:global_step/sec: 272.034
INFO:tensorflow:global_step/sec: 272.33
INFO:tensorflow:global_step/sec: 267.833
INFO:tensorflow:global_step/sec: 268.714
INFO:tensorflow:global_step/sec: 270.555
Worker 0,  Epoch: 4 Cost: 0.3363
gs-> 4078
INFO:tensorflow:global_step/sec: 267.582
INFO:tensorflow:global_step/sec: 269.601
INFO:tensorflow:global_step/sec: 272.096
INFO:tensorflow:global_step/sec: 269.019
INFO:tensorflow:global_step/sec: 275.247
INFO:tensorflow:global_step/sec: 275.365
INFO:tensorflow:global_step/sec: 275.209
INFO:tensorflow:global_step/sec: 281.684
INFO:tensorflow:global_step/sec: 282.2
INFO:tensorflow:global_step/sec: 282.1
Worker 0,  Epoch: 5 Cost: 0.2753
gs-> 5078
INFO:tensorflow:global_step/sec: 283.666
INFO:tensorflow:global_step/sec: 280.292
INFO:tensorflow:global_step/sec: 278.667
INFO:tensorflow:global_step/sec: 279.964
INFO:tensorflow:global_step/sec: 279.507
INFO:tensorflow:global_step/sec: 280.181
INFO:tensorflow:global_step/sec: 278.755
INFO:tensorflow:global_step/sec: 280.311
INFO:tensorflow:global_step/sec: 277.784
INFO:tensorflow:global_step/sec: 279.825
Worker 0,  Epoch: 6 Cost: 0.2350
gs-> 6078
INFO:tensorflow:global_step/sec: 276.893
INFO:tensorflow:global_step/sec: 279.455
INFO:tensorflow:global_step/sec: 281.77
INFO:tensorflow:global_step/sec: 271.03
INFO:tensorflow:global_step/sec: 277.668
INFO:tensorflow:global_step/sec: 281.556
INFO:tensorflow:global_step/sec: 280.091
INFO:tensorflow:global_step/sec: 279.105
INFO:tensorflow:global_step/sec: 279.277
INFO:tensorflow:global_step/sec: 280.255
Worker 0,  Epoch: 7 Cost: 0.2069
gs-> 7078
INFO:tensorflow:global_step/sec: 275.03
INFO:tensorflow:global_step/sec: 277.826
INFO:tensorflow:global_step/sec: 270.195
INFO:tensorflow:global_step/sec: 282.475
INFO:tensorflow:global_step/sec: 272.498
INFO:tensorflow:global_step/sec: 273.35
INFO:tensorflow:global_step/sec: 265.266
INFO:tensorflow:global_step/sec: 275.587
INFO:tensorflow:global_step/sec: 272.372
INFO:tensorflow:global_step/sec: 277.568
Worker 0,  Epoch: 8 Cost: 0.1866
gs-> 8078
INFO:tensorflow:global_step/sec: 283.22
INFO:tensorflow:global_step/sec: 283.293
INFO:tensorflow:global_step/sec: 278.036
INFO:tensorflow:global_step/sec: 280.154
INFO:tensorflow:global_step/sec: 279.912
INFO:tensorflow:global_step/sec: 285.893
INFO:tensorflow:global_step/sec: 282.445
INFO:tensorflow:global_step/sec: 280.965
INFO:tensorflow:global_step/sec: 282.075
INFO:tensorflow:global_step/sec: 281.102
Worker 0,  Epoch: 9 Cost: 0.1711
gs-> 9078
INFO:tensorflow:global_step/sec: 276.902
INFO:tensorflow:global_step/sec: 278.538
INFO:tensorflow:global_step/sec: 280.912
INFO:tensorflow:global_step/sec: 281.741
INFO:tensorflow:global_step/sec: 279.547
INFO:tensorflow:global_step/sec: 284.481
INFO:tensorflow:global_step/sec: 281.473
INFO:tensorflow:global_step/sec: 272.014
INFO:tensorflow:global_step/sec: 271.723
INFO:tensorflow:global_step/sec: 273.255
Worker 0,  Epoch: 10 Cost: 0.1591
gs-> 10078
INFO:tensorflow:global_step/sec: 271.535
INFO:tensorflow:Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany
2019-04-23 15:49:30.669417: W tensorflow/core/distributed_runtime/master_session.cc:1363] Timeout for closing worker session
Traceback (most recent call last):
  File "lr_sync.py", line 153, in <module>
    _,gs,loss = mon_sess.run([optimizer,global_step,cost],feed_dict={X: batch_x, Y: batch_y})
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 676, in run
    run_metadata=run_metadata)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1171, in run
    run_metadata=run_metadata)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1270, in run
    raise six.reraise(*original_exc_info)
  File "/users/dporte7/.local/lib/python3.6/site-packages/six.py", line 693, in reraise
    raise value
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1255, in run
Exception in thread QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/queue_runner_impl.py", line 273, in _run
    coord.request_stop(e)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/coordinator.py", line 213, in request_stop
    six.reraise(*sys.exc_info())
  File "/users/dporte7/.local/lib/python3.6/site-packages/six.py", line 693, in reraise
    raise value
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/queue_runner_impl.py", line 257, in _run
    enqueue_callable()
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1257, in _single_operation_run
    self._call_tf_sessionrun(None, {}, [], target_list, None)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.CancelledError: Step was cancelled by an explicit call to `Session::Close()`.

    return self._sess.run(*args, **kwargs)
  File "/users/dporte7/.local/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1309, in run
    raise RuntimeError('Run called even after should_stop requested.')
RuntimeError: Run called even after should_stop requested.
